<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>灰度图</title>
    <style>
        #can {
            width: 600px; height: 600px;
        }
    </style>
</head>
<body>
    <canvas id='can'></canvas>
    <button onclick="black()">灰度图</button>
</body>
<script>
    function black() {
        const canvas = document.getElementById(`can`)
        const ctx = canvas.getContext('2d')
        const img = new Image()
        img.crossOrigin = 'file';
        img.height = img.width = canvas.width = canvas.height = 600
        img.src = `b68bccd8c7f7aaa857eddef5bb33959b_b.png`
        img.onload = () => {
            ctx.drawImage(img, 0, 0)
            const imgData = ctx.getImageData(0, 0, 600, 600)
            for(let i = 0, {data} = imgData; i < data.length; i += 4) {
                const aver = (data[i] + data[i+1] + data[i+2]) / 3
                data[i] = aver
                data[i+1] = aver
                data[i+2] = aver
            }
            ctx.putImageData(imgData, 0, 0)
        }
        
    }
    black()
</script>
</html>